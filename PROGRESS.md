# Floqly — Прогресс разработки

> Последнее обновление: 2026-02-03
> Текущая фаза: **2. Cookie Generator**

---

## Легенда

- [ ] Не начато
- [~] В процессе
- [x] Завершено
- [!] Заблокировано

---

## Фаза 1: Фундамент

### 1.1 Настройка монорепозитория
- [x] Инициализация pnpm workspaces
- [x] Создание структуры папок (apps/, packages/)
- [x] Настройка корневого package.json
- [x] Настройка .gitignore
- [x] Инициализация git репозитория

### 1.2 Конфигурация (packages/config)
- [x] TypeScript конфиг (strict mode)
- [x] ESLint конфиг
- [x] Prettier конфиг
- [x] Tailwind CSS конфиг

### 1.3 Next.js приложение (apps/web)
- [x] Инициализация Next.js 16.1.6 + React 19.2.3
- [x] Настройка App Router (async params!)
- [x] Подключение Tailwind CSS v4
- [x] Настройка тёмной/светлой темы (OKLCH цвета, ThemeProvider, ThemeToggle)
- [x] Базовая структура маршрутов:
  - [x] (marketing)/ — главная, лендинги
  - [x] (dashboard)/ — личный кабинет
  - [x] (tools)/ — генераторы (Cookie, Simple Widget)
  - [x] api/ — API routes (health, widgets CRUD)

### 1.4 Виджет (apps/widget)
- [x] Инициализация Vite + TypeScript
- [x] Настройка Shadow DOM изоляции
- [x] Конфигурация билда (минификация, gzip)
- [x] Настройка нейтральных имён файлов (fl-helper.js)

### 1.5 Supabase
- [x] Создание проекта в Supabase
- [x] Настройка packages/database
- [x] Создание схемы БД (миграции):
  - [x] profiles (расширение auth.users)
  - [x] projects
  - [x] widgets
  - [x] conversations
  - [x] messages
  - [x] analytics_events
  - [x] leads
- [x] Настройка RLS политик
- [x] Генерация TypeScript типов

### 1.6 UI-кит (packages/ui)
- [ ] Настройка Storybook (опционально)
- [x] Базовые компоненты:
  - [x] Button (CVA варианты, loading, иконки)
  - [x] Input (+ Textarea, Label, error state)
  - [x] Card (+ Header, Title, Description, Content, Footer)
  - [x] Modal (+ Header, Title, Description, Footer, Close)
  - [x] Dropdown (+ Item, Separator, Label)
  - [ ] Toast/Notification
  - [x] Tabs (+ List, Trigger, Content)
  - [x] Accordion (+ Item, Trigger, Content)
  - [x] Badge (варианты)
  - [x] Switch
- [x] Тема (OKLCH цвета, типографика, spacing)
- [x] Поддержка тёмной темы

### 1.7 Аналитика (packages/analytics)
- [x] Базовый трекер событий
- [x] Интеграция Yandex Метрика (подготовлена)

### 1.8 CI/CD
- [x] GitHub репозиторий (floqlyproject-hue/floqly)
- [x] GitHub Actions workflow:
  - [x] Lint + Type check
  - [x] Build (web + widget)
  - [ ] Deploy preview
  - [ ] Production deploy

---

## Фаза 2: Cookie Generator

### 2.1 UI Генератора
- [x] Страница /tools/cookie-generator
- [x] Компонент редактора настроек:
  - [x] Информация о компании (название, сайт, email, ссылка на политику)
  - [x] Типы cookie (необходимые, аналитические, маркетинговые, функциональные)
  - [x] Положение (Bottom/Top/Floating/Corner)
  - [x] Цветовая схема (светлая/тёмная/брендовая)
  - [x] Шаблоны текста (минимальный/стандартный/подробный/юридический/свой)
  - [x] Кнопки (принять/отклонить/настройки)
  - [x] Эффекты (backdrop blur, анимации)
  - [x] Срок скрытия (дни)
- [x] Live Preview компонент
- [x] Модальное окно с embed-кодом
- [x] Таб "Документ" с полным текстом политики (копирование, скачивание .md)
- [x] Progress bar и контекстные подсказки
- [x] UX polish: cursor-pointer, focus states, completed step indicators

### 2.2 Воронка регистрации
- [~] Блокер "Получить код" (частично: CTA на регистрацию в модалке)
- [ ] Модальное окно регистрации/входа
- [ ] OAuth кнопки (Yandex, VK, Google, Telegram)
- [ ] Email + Magic Link

### 2.3 Бэкенд
- [ ] API сохранения конфигурации виджета
- [ ] Генерация уникального widget_id
- [ ] Выдача embed-кода

### 2.4 Embed-скрипт Cookie
- [ ] Скрипт загрузки (cdn.floqly.ru/c.js)
- [ ] Рендеринг плашки из конфига
- [ ] Логика принятия/отклонения
- [ ] Сохранение в localStorage/cookie
- [ ] 152-ФЗ / GDPR compliance

---

## Фаза 3: Simple Widget (Конструктор кнопок)

### 3.1 UI Конструктора
- [ ] Страница /tools/simple-widget
- [ ] Выбор каналов (WhatsApp, Telegram, VK, etc.)
- [ ] Drag & Drop сортировка
- [ ] Настройки позиции (4 угла + offset)
- [ ] Цветовая схема
- [ ] Call-to-Action облачко
- [ ] Анимации появления

### 3.2 Режимы отображения
- [ ] FAB с раскрывающимся меню
- [ ] Несколько отдельных кнопок

### 3.3 Callback-форма
- [ ] Встроенная форма обратного звонка
- [ ] Валидация телефона
- [ ] Отправка лида

### 3.4 Embed-скрипт Simple Widget
- [ ] Скрипт загрузки
- [ ] Рендеринг кнопок
- [ ] Анимации
- [ ] Callback-форма

---

## Фаза 4: Личный кабинет (Dashboard)

### 4.1 Авторизация
- [ ] Страница входа
- [ ] Страница регистрации
- [ ] OAuth провайдеры
- [ ] Magic Link
- [ ] Защита маршрутов (middleware)

### 4.2 Overview
- [ ] Список проектов (сайтов)
- [ ] Создание нового проекта
- [ ] Статус виджетов
- [ ] Быстрая статистика

### 4.3 Редактор виджетов
- [ ] Левая панель: настройки (аккордеон)
- [ ] Правая панель: Live Preview
- [ ] Сохранение конфигурации
- [ ] Получение embed-кода

### 4.4 Настройки проекта
- [ ] Домен(ы)
- [ ] Webhooks для CRM
- [ ] Telegram-бот подключение

### 4.5 Настройки аккаунта
- [ ] Профиль
- [ ] Безопасность
- [ ] Тарифный план (заглушка)

---

## Фаза 5: Умный виджет (AI Chat)

### 5.1 Компоненты виджета
- [ ] Launcher (кнопка)
  - [ ] Аватар/логотип
  - [ ] Анимация пульсации
  - [ ] Счётчик непрочитанных
- [ ] Teaser (пузырёк)
  - [ ] Статический режим
  - [ ] Контекстный режим
  - [ ] Настраиваемая задержка
- [ ] Main Container (окно чата)
  - [ ] Header
  - [ ] Body (лента сообщений)
  - [ ] Markdown поддержка
  - [ ] Quick Reply кнопки
  - [ ] Карточки товаров
  - [ ] Typing indicator
  - [ ] Input Area
  - [ ] Footer (брендинг)

### 5.2 Поведение виджета
- [ ] Триггеры появления:
  - [ ] Сразу при загрузке
  - [ ] Через X секунд
  - [ ] При скролле до Y%
  - [ ] Exit intent
- [ ] Офлайн-режим (форма заявки)
- [ ] Сохранение истории (localStorage + сервер)

### 5.3 Интеграция с AI (Илья)
- [ ] Уточнить детали API
- [ ] Реализовать отправку сообщений
- [ ] Обработка ответов
- [ ] Streaming (если поддерживается)

### 5.4 Human Handoff
- [ ] Кнопка "Позвать оператора"
- [ ] Уведомление в Telegram
- [ ] Статус ожидания

### 5.5 Дизайн-система (скины)
- [ ] Default (Floqly)
- [ ] Dark Mode
- [ ] Строгий банк
- [ ] Игривый стартап
- [ ] Minimal
- [ ] Glassmorphism
- [ ] Custom CSS

---

## Фаза 6: Главная страница (Marketing)

### 6.1 Hero секция
- [ ] Виджет как главный герой
- [ ] Демо-диалог
- [ ] Анимация (Framer Motion)

### 6.2 The Widget Journey (скролл-анимация)
- [ ] Lenis Scroll интеграция
- [ ] GSAP ScrollTrigger
- [ ] Виджет следует за скроллом
- [ ] Смена скинов
- [ ] CTA трансформация

### 6.3 Контент
- [ ] Секция проблем
- [ ] Секция решений
- [ ] Тарифы
- [ ] FAQ
- [ ] Footer

### 6.4 SEO
- [ ] Meta теги
- [ ] Open Graph
- [ ] Structured Data
- [ ] Семантическое ядро (TBD)

---

## Фаза 7: Доработки и полировка

### 7.1 Аналитика (расширенная)
- [ ] История диалогов
- [ ] Графики по времени
- [ ] Экспорт CSV/JSON

### 7.2 Блог + Документация
- [ ] MDX интеграция
- [ ] Структура /blog
- [ ] Структура /docs

### 7.3 Админ-панель (apps/admin)
- [ ] Список пользователей
- [ ] Управление тарифами
- [ ] Статистика платформы

### 7.4 WebGL анимации (после MVP)
- [ ] Three.js / React Three Fiber
- [ ] 3D виджет на главной

---

## Открытые вопросы

| Вопрос | Статус | Решение |
|--------|--------|---------|
| Версия Next.js | Решено | **Next.js 16.1.1** (skill загружен) |
| API интеграция с AI (Илья) | Не обсуждено | — |
| Брендинг (логотип, цвета) | Не создано | — |
| Ценообразование тарифов | Не определено | — |
| Семантическое ядро для SEO | Не собрано | — |

---

## История изменений

| Дата | Изменение |
|------|-----------|
| 2026-02-02 | Создан файл PROGRESS.md |
| 2026-02-02 | Определена версия: Next.js 16.1.1 + React 19.2 |
| 2026-02-02 | **Фаза 1 (частично)**: Монорепо, конфиги, Next.js 16.1.6, Виджет, packages |
| 2026-02-03 | **Фаза 1 (продолжение)**: Дизайн-система (OKLCH), ThemeProvider, структура маршрутов, UI-кит (10 компонентов) |
| 2026-02-03 | **Supabase**: Схема БД (7 таблиц), RLS политики, TypeScript типы, SSR клиенты, middleware |
| 2026-02-03 | **GitHub**: Репозиторий floqlyproject-hue/floqly, CI workflow (lint, type-check, build) |
| 2026-02-03 | **Фаза 2**: Cookie Generator UI (форма настроек, типы cookie, шаблоны текста, live preview, модалка кода) |
