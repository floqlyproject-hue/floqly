# Product Requirements Document (PRD): Floqly (Extended Edition)

| Метаданные | Описание |
| :--- | :--- |
| **Продукт** | Floqly (floqly.ru) |
| **Версия документа** | 2.1 (Design Overhaul) |
| **Статус** | **Approved for Design & Dev** |
| **Владелец продукта** | Никита |
| **Тех. Партнер** | Илья (AI/Backend Logic) |
| **Модель монетизации** | Freemium (PLG - Product Led Growth) |

---

## 1. Контекст и Проблематика (Problem & Solution)

### 1.1 Проблема (The Pain)
Владельцы малого и среднего бизнеса тратят деньги на трафик, но сайты остаются статичными "визитками". Посетители уходят, не найдя ответа мгновенно. Стандартные чат-боты глупые, а операторы спят. Конверсия сайтов падает.
Также, вебмастерам и маркетологам постоянно нужны мелкие инструменты (Cookie, кнопки соцсетей), за которые они не хотят платить, но готовы терпеть неудобные сервисы.

### 1.2 Решение (The Solution)
**Floqly** — это экосистема.
1.  **Для привлечения:** Мы даем идеальные бесплатные инструменты (Cookie Generator, Simple Widget), которые лучше конкурентов по UI/UX.
2.  **Для удержания:** Мы конвертируем пользователей бесплатных инструментов в экосистему Floqly.
3.  **Для дохода:** Мы предлагаем "Умный Виджет", который работает как лучший менеджер по продажам 24/7, анализируя контекст страницы.

---

## 2. Целевая аудитория (User Personas)

| Персона | Описание | Потребность |
| :--- | :--- | :--- |
| **Веб-разработчик / Фрилансер** | Делает сайты клиентам. Ищет быстрый способ сгенерировать плашку Cookie или кнопку WhatsApp. | "Мне нужно быстро, бесплатно и чтобы выглядело не колхозно. Если понравится, поставлю клиенту вашу платную версию." |
| **Владелец малого бизнеса** | Сам ковыряет свой сайт. Хочет продаж. | "Я хочу, чтобы сайт продавал, но я не умею программировать. Дайте мне магическую кнопку." |
| **Маркетолог** | Отвечает за конверсию. | "Мне нужна аналитика и инструмент, который реально вовлекает, а не просто висит." |

---

## 3. Детальные функциональные требования (Functional Specs)

### 3.1. Главная страница (Marketing Site & Showroom)
*Это лицо проекта. Самая сложная часть фронтенда.*

*   **Концепция:** "Живой сайт". Виджет не просто висит в углу, он — главный герой.
*   **Сценарий анимации (The Widget Journey):**
    1.  **Секция Hero:** Виджет находится в центре экрана, крупно. Демонстрирует диалог: "Привет, я подниму твои продажи".
    2.  **Скролл к "Проблемам":** Виджет "сжимается" в шар/логотип и улетает за курсором мыши, комментируя блоки ("Вот тут обычно клиенты уходят...").
    3.  **Секция "Демо":** Виджет прилипает (Sticky) к правому нижнему углу (как в реальной жизни) и меняет скин (Дизайн 1 -> Дизайн 2 -> Дизайн 3), показывая кастомизацию.
    4.  **Секция "Цены/CTA":** Виджет раскрывается в форму заявки прямо на странице.
*   **Технические требования:**
    *   Использование WebGL или продвинутого CSS/SVG (GSAP).
    *   Отсутствие лагов при скролле (Debounce/Throttle событий).

### 3.2. Бесплатный инструмент: Cookie Generator
*Точка входа трафика (SEO Trap).*

*   **Функционал:**
    *   **Настройки:** Положение (Bottom/Top/Floating), Цветовая палитра (Color Picker + пресеты), Текст соглашения (редактируемый HTML), Ссылка на "Политику".
    *   **Продвинутые настройки (Hook):** "Скрывать после клика на X дней", "Размытие фона (Backdrop blur)".
*   **Логика получения:**
    *   Пользователь все настроил -> Нажал "Получить код".
    *   **Блокер:** Поп-ап "Сохраните свой виджет в личном кабинете, чтобы редактировать его без переустановки кода".
    *   *Важно:* Код, который мы выдаем — это `<script src="floqly.js?id=USER_ID">`. Конфигурация тянется с нашего сервера. Это позволяет нам обновлять виджет удаленно.

### 3.3. Бесплатный инструмент: Simple Widget (Конструктор кнопок)
*   **Функционал:**
    *   Добавление кнопок: Telegram, WhatsApp, VK, Phone, Email.
    *   Настройка призыва к действию (Call-to-Action) в облачке рядом с кнопкой.
    *   **Дизайн:** Использует ту же дизайн-систему, что и Умный виджет (см. пункт 3.5), но без AI-чата. При клике просто открывает ссылку.

### 3.4. Личный Кабинет (Dashboard)
*Единый центр управления (Single Page Application).*

*   **Структура данных:** `User` -> `Projects` (Сайты) -> `Widgets`.
*   **Разделы:**
    1.  **Овервью:** Список сайтов, статус виджетов (Активен/Не активен).
    2.  **Редактор (Visual Editor):**
        *   Слева: Панель настроек (аккордеон).
        *   Справа: **Live Preview** сайта (iframe или мок-ап), где в реальном времени меняется виджет.
    3.  **Настройка Умного Виджета (Concierge Mode):**
        *   Поле ввода домена.
        *   Drag & Drop зона для загрузки файлов (PDF, DOCX, TXT) — "База знаний".
        *   Поле "Tone of Voice" (формальный, дерзкий, дружелюбный).
        *   Статус-бар: "Получены данные" -> "Анализ (AI)" -> "Генерация промптов" -> "Готов к работе". (В реальности статусы переключаем мы в админке).

### 3.5. "Умный Виджет" (Frontend Implementation)
*Самая важная часть для вашей разработки. То, что видит конечный посетитель.*

*   **Компоненты Виджета:**
    1.  **Launcher (Кнопка):** Круглая или овальная. С аватаром или логотипом. Анимация пульсации, если есть непрочитанное.
    2.  **Teaser (Тизер):** "Пузырек" с сообщением, которое появляется *до* открытия виджета. Пример: "Ищете доставку в Химки? Подскажу цены."
    3.  **Main Container (Окно чата):**
        *   Header: Аватар, Имя, Кнопка закрытия, Меню (три точки).
        *   Body: Лента сообщений. Поддержка Markdown (списки, жирный шрифт), Кнопок-быстрых ответов (Chips), Картинок товаров.
        *   Input Area: Поле ввода + кнопка отправки + (опционально) кнопка прикрепления файла.
*   **Дизайн-система (10+ Skins):**
    *   Вам нужно создать универсальную структуру DOM, где смена класса `.theme-dark` или `.theme-glass` полностью меняет восприятие, но не логику.
    *   **Темы:** "Строгий банк", "Игривый стартап", "Неоморфизм", "iOS Style", "WhatsApp Clone" и т.д.


---

## 4. Технические Требования и Архитектура

### 4.1. Инфраструктура (Docker & Timeweb)
*   **Container 1 (Frontend App):** Next.js / React (SSR для SEO лендингов, CSR для Дашборда).
*   **Container 2 (Backend API):** Node.js или Python. Обрабатывает auth, сохранение настроек JSON.
*   **Container 3 (Widget CDN):** Отдельный легковесный сервис, отдающий статику `widget.js` (должен быть супер-быстрым).

### 4.2. Embed Script (Скрипт встройки)
*   **Изоляция (Shadow DOM):** Критически важно! Стили сайта клиента (Bootstrap, Tailwind) не должны ломать верстку нашего виджета. Мы "прячем" наш виджет в Shadow Root.
*   **Размер:** Bundle виджета не должен превышать 50-70kb (Gzipped).
*   **Загрузка:** `defer` или `async`, чтобы не блокировать отрисовку сайта клиента (Google PageSpeed не должен падать).

### 4.3. Безопасность
*   **CORS:** API должно принимать запросы только с разрешенных доменов (которые клиент указал в ЛК).
*   **Auth:** JWT токены для API ЛК.

---

## 5. План реализации (Расширенный Roadmap)

### Фаза 1: "Приманка" (Cookie Generator + Auth)
1.  **Дизайн:** UI генератора Cookie + UI страницы входа/регистрации.
2.  **Dev:** Верстка генератора. Реализация "фейковой" генерации (показываем превью).
3.  **Dev:** Бэкенд авторизации (Yandex/Email).
4.  **Dev:** Связка: Нажал "Получить" -> Окно регистрации -> Сохранение конфига в БД -> Выдача скрипта.
5.  **Release:** Запуск `/cookie-generator` для индексации поисковиками.

### Фаза 2: "Core Frontend" (Дизайн Виджета)
1.  **Design:** Создание 10 вариантов дизайна виджета
2.  **Animation:** Прототипирование анимаций появления (Fade, Slide, Pop-up, Bounce и т.д).
3.  **Dev:** Верстка библиотеки компонентов виджета (Launcher, Chat Window, Bubble и т.д). Это будет использоваться и для простого, и для умного виджета.
4.  **Test:** Проверка отображения поверх популярных сайтов 

### Фаза 3: "Личный кабинет" (Hub)
1.  **Dev:** Дашборд с перечнем сайтов.
2.  **Dev:** Интеграция "Простого виджета" (кнопки мессенджеров) на базе дизайнов из Фазы 2.
3.  **Dev:** Раздел "Настройки Умного Виджета" (Форма загрузки файлов + Drag&Drop).

### Фаза 4: "Магия" (Главная страница)
1.  **Design & Motion:** Финализация сценария движения виджета.
2.  **Dev:** Верстка лендинга.
3.  **Integration:** Подключение демо-режима виджета на главной.

### Фаза 5: "Интеграция с Партнером"
1.  Настройка передачи файлов клиента из ЛК партнеру.
2.  Настройка API для получения ответов от AI партнера и отображения их в нашем UI виджета.

---

## 6. Метрики успеха (Success Metrics)

*   **CAC (Customer Acquisition Cost):** 0 руб (на этапе органического роста через Cookie Gen).
*   **Conversion to Sign-up:** % посетителей Cookie Gen, которые зарегистрировались.
*   **Activation Rate:** % зарегистрированных, которые реально установили код на сайт.
*   **Widget Load Time:** Время загрузки скрипта (цель < 200ms).

---

## 7. Требования к Дизайну (Design & UX Requirements) - Awwwards Edition

**Общая концепция:** "Immersive Spatial Intelligence".
Сайт не должен выглядеть как классический SaaS-дашборд. Это должно быть погружение в будущее. Мы продаем не виджет, а *технологическое превосходство*.


### 7.1. Моушн и Взаимодействие (Motion & Interaction)
*   **Physics:** Элементы не просто двигаются, они имеют вес и инерцию. Виджет при перетаскивании должен иметь легкий шлейф или эластичность.
*   **Scrollytelling:** Скролл не двигает страницу вниз, а двигает историю вперед.
    *   *Пример:* При скролле интерфейс виджета "разбирается" на слои в 3D (Z-axis), показывая внутреннюю структуру "мозга" AI.
*   **Micro-interactions:** Ни одна кнопка не статична. Магнитное притяжение курсора (Magnetic Buttons). При наведении на границы блоков — эффект свечения (Glow borders).

### 7.2. Презентация Виджета ("Hero" Experience)
*   **3D / WebGL:** Виджет на главной странице — это не картинка и не HTML-код, это WebGL-объект, который можно "покрутить" мышкой, который реагирует на гироскоп телефона.
*   **Fluid Morphing:** Бесшовные трансформации формы виджета. Круг -> Овал -> Квадрат -> Окно чата. Это должно происходить жидко, как ртуть.

### 7.3. Референсы настроения (Moodboard)
*   *Не смотреть:* Стандартные CRM, Bootstap-шаблоны.
*   *Смотреть:* Работы студий *Locomotive*, *Cuberto*, *Unseen Studio*. Сайты с использованием *Lenis Scroll* и *Three.js*.
*   **Цель:** Получить ленточку "Site of the Day" на Awwwards в 2026 году.

---

## 8. Риски и Mitigation (Управление рисками)

| Риск | Вероятность | Решение |
| :--- | :--- | :--- |
| **Блокировщики рекламы (AdBlock)** | Высокая | Использовать нейтральные имена классов и файлов (не называть файл `ad-widget.js`, лучше `fl-helper.js`). |
| **Сложная анимация на главной грузит CPU** | Средняя | Сделать упрощенную версию для мобильных и определять мощность устройства при загрузке. |
| **Партнер задерживает AI-часть** | Средняя | У нас уже готов "Простой виджет" и "Cookie". Мы можем запускаться с ними, а "Умный" держать в предзаказе (Waitlist). |
| **Клиент не умеет ставить код** | Высокая | Сделать плагины для WordPress / Tilda в будущем или написать супер-подробные инструкции с картинками в ЛК. |

